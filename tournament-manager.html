<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Tournament Manager</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 3px solid #667eea;
            overflow-x: auto;
        }

        .tab {
            padding: 15px 30px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
            margin-bottom: -3px;
        }

        .content {
            padding: 30px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin: 5px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .template-card {
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .template-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .template-card h3 {
            color: #667eea;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .template-card .icon {
            font-size: 2em;
        }

        .template-card p {
            color: #666;
            line-height: 1.6;
        }

        .template-card ul {
            margin-top: 10px;
            padding-left: 20px;
            color: #666;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }

        th {
            background: #f9fafb;
            font-weight: 600;
            color: #374151;
        }

        tr:hover {
            background: #f9fafb;
        }

        .team-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .team-card {
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 15px;
            background: #f9fafb;
        }

        .team-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-info {
            background: #dbeafe;
            color: #1e40af;
            border-left: 4px solid #3b82f6;
        }

        .alert-success {
            background: #d1fae5;
            color: #065f46;
            border-left: 4px solid #10b981;
        }

        .alert-warning {
            background: #fef3c7;
            color: #92400e;
            border-left: 4px solid #f59e0b;
        }

        .wizard {
            max-width: 800px;
            margin: 0 auto;
        }

        .wizard-step {
            display: none;
        }

        .wizard-step.active {
            display: block;
        }

        .wizard-progress {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            position: relative;
        }

        .wizard-progress::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 2px;
            background: #e5e7eb;
            z-index: 0;
        }

        .wizard-progress-step {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            position: relative;
            z-index: 1;
        }

        .wizard-progress-step.completed,
        .wizard-progress-step.active {
            background: #667eea;
            color: white;
        }

        .config-preview {
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .config-preview h4 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .config-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .config-item:last-child {
            border-bottom: none;
        }

        .score-input {
            display: flex;
            gap: 20px;
            align-items: center;
            margin: 10px 0;
        }

        .score-input input {
            width: 80px;
            text-align: center;
            font-size: 24px;
            font-weight: 600;
        }

        .match-card {
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            background: white;
        }

        .match-card:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .match-teams {
            display: flex;
            justify-content: space-around;
            align-items: center;
            gap: 20px;
        }

        .match-team {
            flex: 1;
            text-align: center;
        }

        .match-team h4 {
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .match-score {
            font-size: 2em;
            font-weight: 700;
            color: #667eea;
        }

        .vs {
            font-size: 1.5em;
            font-weight: 600;
            color: #666;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-live {
            background: #ef4444;
            color: white;
            animation: pulse 2s infinite;
        }

        .badge-completed {
            background: #10b981;
            color: white;
        }

        .badge-scheduled {
            background: #f59e0b;
            color: white;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-card .number {
            font-size: 3em;
            font-weight: 700;
            margin: 10px 0;
        }

        .stat-card .label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .tabs {
                flex-wrap: wrap;
            }

            .tab {
                flex: 1;
                min-width: 120px;
            }

            .content {
                padding: 15px;
            }

            .template-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèÜ Universal Tournament Manager</h1>
            <p>Create and manage tournaments for any sport - Cricket, Football, Basketball, and more!</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('setup')">üéØ Setup</button>
            <button class="tab" onclick="switchTab('templates')">üìã Templates</button>
            <button class="tab" onclick="switchTab('teams')">üë• Teams</button>
            <button class="tab" onclick="switchTab('schedule')">üìÖ Schedule</button>
            <button class="tab" onclick="switchTab('live')">üî¥ Live Score</button>
            <button class="tab" onclick="switchTab('standings')">üìä Standings</button>
            <button class="tab" onclick="switchTab('stats')">üìà Stats</button>
        </div>

        <div class="content">
            <!-- Setup Tab -->
            <div id="setup" class="tab-content active">
                <div class="wizard">
                    <div class="alert alert-info">
                        <strong>üëã Welcome!</strong> Let's set up your tournament in a few easy steps. You can also use our pre-made templates to get started instantly!
                    </div>

                    <div class="wizard-progress">
                        <div class="wizard-progress-step active">1</div>
                        <div class="wizard-progress-step">2</div>
                        <div class="wizard-progress-step">3</div>
                        <div class="wizard-progress-step">4</div>
                    </div>

                    <div class="wizard-step active" id="step1">
                        <h2>Step 1: Basic Information</h2>
                        <div class="form-group">
                            <label>Tournament Name</label>
                            <input type="text" id="tournamentName" placeholder="e.g., Summer Championship 2024">
                        </div>
                        <div class="form-group">
                            <label>Sport Type</label>
                            <select id="sportType" onchange="updateSportFields()">
                                <option value="">-- Select Sport --</option>
                                <option value="cricket">üèè Cricket</option>
                                <option value="football">‚öΩ Football/Soccer</option>
                                <option value="basketball">üèÄ Basketball</option>
                                <option value="volleyball">üèê Volleyball</option>
                                <option value="tennis">üéæ Tennis</option>
                                <option value="badminton">üè∏ Badminton</option>
                                <option value="table-tennis">üèì Table Tennis</option>
                                <option value="hockey">üèë Hockey</option>
                                <option value="baseball">‚öæ Baseball</option>
                                <option value="rugby">üèâ Rugby</option>
                                <option value="custom">üéØ Custom Sport</option>
                            </select>
                        </div>
                        <div class="form-group" id="customSportDiv" style="display:none;">
                            <label>Custom Sport Name</label>
                            <input type="text" id="customSportName" placeholder="Enter your sport name">
                        </div>
                        <div class="form-group">
                            <label>Tournament Format</label>
                            <select id="tournamentFormat">
                                <option value="round-robin">Round Robin (Everyone plays everyone)</option>
                                <option value="knockout">Single Elimination (Knockout)</option>
                                <option value="double-elimination">Double Elimination</option>
                                <option value="group-knockout">Group Stage + Knockout</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" onclick="nextStep(2)">Next Step ‚Üí</button>
                    </div>

                    <div class="wizard-step" id="step2">
                        <h2>Step 2: Teams Configuration</h2>
                        <div class="form-group">
                            <label>Number of Teams</label>
                            <input type="number" id="numTeams" min="2" max="32" value="6" onchange="generateTeamInputs()">
                        </div>
                        <div id="teamInputs"></div>
                        <button class="btn btn-secondary" onclick="nextStep(1)">‚Üê Previous</button>
                        <button class="btn btn-primary" onclick="nextStep(3)">Next Step ‚Üí</button>
                    </div>

                    <div class="wizard-step" id="step3">
                        <h2>Step 3: Scoring & Match Rules</h2>
                        <div id="scoringRules"></div>
                        <div class="form-group">
                            <label>Points for Win</label>
                            <input type="number" id="pointsWin" value="3" min="0">
                        </div>
                        <div class="form-group">
                            <label>Points for Draw/Tie</label>
                            <input type="number" id="pointsDraw" value="1" min="0">
                        </div>
                        <div class="form-group">
                            <label>Points for Loss</label>
                            <input type="number" id="pointsLoss" value="0" min="0">
                        </div>
                        <button class="btn btn-secondary" onclick="nextStep(2)">‚Üê Previous</button>
                        <button class="btn btn-primary" onclick="nextStep(4)">Next Step ‚Üí</button>
                    </div>

                    <div class="wizard-step" id="step4">
                        <h2>Step 4: Review & Create</h2>
                        <div class="config-preview" id="configPreview"></div>
                        <button class="btn btn-secondary" onclick="nextStep(3)">‚Üê Previous</button>
                        <button class="btn btn-success" onclick="createTournament()">üéâ Create Tournament</button>
                    </div>
                </div>
            </div>

            <!-- Templates Tab -->
            <div id="templates" class="tab-content">
                <h2>üìã Tournament Templates</h2>
                <p>Choose a pre-configured template to get started instantly. All settings can be customized later!</p>
                
                <div class="template-grid">
                    <div class="template-card" onclick="loadTemplate('gully-cricket')">
                        <h3><span class="icon">üèè</span> Gully Cricket</h3>
                        <p>Authentic street cricket experience with quick 6-over matches</p>
                        <ul>
                            <li>6 teams with fun names</li>
                            <li>Round-robin format</li>
                            <li>6 overs per innings</li>
                            <li>Best of 3 per fixture</li>
                        </ul>
                    </div>

                    <div class="template-card" onclick="loadTemplate('premier-league')">
                        <h3><span class="icon">‚öΩ</span> Football League</h3>
                        <p>Professional football league format</p>
                        <ul>
                            <li>20 teams</li>
                            <li>Round-robin (home & away)</li>
                            <li>90-minute matches</li>
                            <li>3 points for win</li>
                        </ul>
                    </div>

                    <div class="template-card" onclick="loadTemplate('basketball-tournament')">
                        <h3><span class="icon">üèÄ</span> Basketball Tournament</h3>
                        <p>Fast-paced basketball tournament</p>
                        <ul>
                            <li>8 teams</li>
                            <li>Single elimination</li>
                            <li>4 quarters (10 min each)</li>
                            <li>Best of 3 finals</li>
                        </ul>
                    </div>

                    <div class="template-card" onclick="loadTemplate('volleyball-championship')">
                        <h3><span class="icon">üèê</span> Volleyball Championship</h3>
                        <p>Classic volleyball tournament format</p>
                        <ul>
                            <li>12 teams in 3 groups</li>
                            <li>Group + knockout format</li>
                            <li>Best of 5 sets</li>
                            <li>Rally scoring (25 points)</li>
                        </ul>
                    </div>

                    <div class="template-card" onclick="loadTemplate('tennis-open')">
                        <h3><span class="icon">üéæ</span> Tennis Open</h3>
                        <p>Professional tennis tournament</p>
                        <ul>
                            <li>32 players/teams</li>
                            <li>Single elimination</li>
                            <li>Best of 3 sets</li>
                            <li>Tie-break rules</li>
                        </ul>
                    </div>

                    <div class="template-card" onclick="loadTemplate('office-badminton')">
                        <h3><span class="icon">üè∏</span> Office Badminton</h3>
                        <p>Casual office badminton tournament</p>
                        <ul>
                            <li>Flexible team count</li>
                            <li>Round-robin format</li>
                            <li>Best of 3 games (21 points)</li>
                            <li>Quick lunch-time matches</li>
                        </ul>
                    </div>

                    <div class="template-card" onclick="loadTemplate('world-cup')">
                        <h3><span class="icon">üèÜ</span> World Cup Style</h3>
                        <p>International tournament format (any sport)</p>
                        <ul>
                            <li>32 teams in 8 groups</li>
                            <li>Group stage + knockout</li>
                            <li>Top 2 from each group advance</li>
                            <li>Single elimination playoffs</li>
                        </ul>
                    </div>

                    <div class="template-card" onclick="loadTemplate('weekend-casual')">
                        <h3><span class="icon">üéØ</span> Weekend Casual</h3>
                        <p>Relaxed weekend tournament for friends</p>
                        <ul>
                            <li>4-8 teams</li>
                            <li>Simple round-robin</li>
                            <li>Flexible match duration</li>
                            <li>Fun-focused scoring</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Teams Tab -->
            <div id="teams" class="tab-content">
                <h2>üë• Manage Teams</h2>
                <div class="alert alert-info" id="teamsAlert">
                    Please create a tournament first in the Setup tab or choose a template!
                </div>
                <div id="teamsContent" style="display:none;">
                    <button class="btn btn-primary" onclick="addNewTeam()">‚ûï Add Team</button>
                    <div class="team-list" id="teamsList"></div>
                </div>
            </div>

            <!-- Schedule Tab -->
            <div id="schedule" class="tab-content">
                <h2>üìÖ Match Schedule</h2>
                <div class="alert alert-info" id="scheduleAlert">
                    Please create a tournament first in the Setup tab or choose a template!
                </div>
                <div id="scheduleContent" style="display:none;">
                    <button class="btn btn-primary" onclick="generateSchedule()">üîÑ Generate Schedule</button>
                    <button class="btn btn-secondary" onclick="exportSchedule()">üì• Export Schedule</button>
                    <div id="matchesList"></div>
                </div>
            </div>

            <!-- Live Score Tab -->
            <div id="live" class="tab-content">
                <h2>üî¥ Live Scoring</h2>
                <div class="alert alert-info" id="liveAlert">
                    Please create a tournament and generate a schedule first!
                </div>
                <div id="liveContent" style="display:none;">
                    <div class="form-group">
                        <label>Select Match to Score</label>
                        <select id="liveMatchSelect" onchange="loadLiveMatch()">
                            <option value="">-- Select a Match --</option>
                        </select>
                    </div>
                    <div id="liveScoreBoard"></div>
                </div>
            </div>

            <!-- Standings Tab -->
            <div id="standings" class="tab-content">
                <h2>üìä Tournament Standings</h2>
                <div class="alert alert-info" id="standingsAlert">
                    Please create a tournament first in the Setup tab or choose a template!
                </div>
                <div id="standingsContent" style="display:none;">
                    <button class="btn btn-secondary" onclick="exportStandings()">üì• Export Standings</button>
                    <table id="standingsTable">
                        <thead>
                            <tr>
                                <th>Pos</th>
                                <th>Team</th>
                                <th>P</th>
                                <th>W</th>
                                <th>D</th>
                                <th>L</th>
                                <th>Pts</th>
                            </tr>
                        </thead>
                        <tbody id="standingsBody"></tbody>
                    </table>
                </div>
            </div>

            <!-- Stats Tab -->
            <div id="stats" class="tab-content">
                <h2>üìà Tournament Statistics</h2>
                <div class="alert alert-info" id="statsAlert">
                    Please create a tournament and play some matches to see statistics!
                </div>
                <div id="statsContent" style="display:none;">
                    <div class="stats-grid" id="statsGrid"></div>
                    <h3 style="margin-top: 30px;">Top Performers</h3>
                    <div id="topPerformers"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global tournament state
        let tournament = {
            name: '',
            sport: '',
            format: '',
            teams: [],
            matches: [],
            config: {}
        };

        // Sport-specific configurations
        const sportConfigs = {
            cricket: {
                scoreFields: ['Runs', 'Wickets', 'Overs'],
                matchDuration: '6 overs',
                icon: 'üèè'
            },
            football: {
                scoreFields: ['Goals'],
                matchDuration: '90 minutes',
                icon: '‚öΩ'
            },
            basketball: {
                scoreFields: ['Points'],
                matchDuration: '4 x 10 minutes',
                icon: 'üèÄ'
            },
            volleyball: {
                scoreFields: ['Sets', 'Points'],
                matchDuration: 'Best of 5 sets',
                icon: 'üèê'
            },
            tennis: {
                scoreFields: ['Sets', 'Games'],
                matchDuration: 'Best of 3 sets',
                icon: 'üéæ'
            }
        };

        // Template presets
        const templates = {
            'gully-cricket': {
                name: 'Zenith Gully Cricket Tournament',
                sport: 'cricket',
                format: 'round-robin',
                numTeams: 6,
                teams: [
                    'Mohalla Masters', 'Street Kings', 'Gully Warriors',
                    'Compound Champions', 'Badass Ballers', 'Terrace Tigers'
                ],
                config: {
                    overs: 6,
                    matchType: 'Best of 3',
                    pointsWin: 2,
                    pointsDraw: 1,
                    pointsLoss: 0
                }
            },
            'premier-league': {
                name: 'Premier Football League',
                sport: 'football',
                format: 'round-robin',
                numTeams: 8,
                teams: [
                    'FC Thunder', 'United Warriors', 'City Strikers', 'Athletic Champions',
                    'Real Legends', 'FC Galaxy', 'United Phoenix', 'City Rangers'
                ],
                config: {
                    matchDuration: 90,
                    pointsWin: 3,
                    pointsDraw: 1,
                    pointsLoss: 0
                }
            },
            'basketball-tournament': {
                name: 'Basketball Championship',
                sport: 'basketball',
                format: 'knockout',
                numTeams: 8,
                teams: [
                    'Lakers', 'Warriors', 'Bulls', 'Celtics',
                    'Heat', 'Mavericks', 'Rockets', 'Spurs'
                ],
                config: {
                    quarters: 4,
                    quarterDuration: 10,
                    pointsWin: 2,
                    pointsLoss: 0
                }
            },
            'volleyball-championship': {
                name: 'Volleyball Championship',
                sport: 'volleyball',
                format: 'group-knockout',
                numTeams: 12,
                teams: [
                    'Spikers', 'Net Kings', 'Blockers', 'Servers',
                    'Jump Squad', 'Court Masters', 'Volley Warriors', 'Ace Team',
                    'Power Hitters', 'Defense Force', 'Rally Rangers', 'Set Stars'
                ],
                config: {
                    sets: 'Best of 5',
                    pointsPerSet: 25,
                    pointsWin: 3,
                    pointsLoss: 0
                }
            },
            'tennis-open': {
                name: 'Tennis Open Championship',
                sport: 'tennis',
                format: 'knockout',
                numTeams: 16,
                teams: [
                    'Player 1', 'Player 2', 'Player 3', 'Player 4',
                    'Player 5', 'Player 6', 'Player 7', 'Player 8',
                    'Player 9', 'Player 10', 'Player 11', 'Player 12',
                    'Player 13', 'Player 14', 'Player 15', 'Player 16'
                ],
                config: {
                    sets: 'Best of 3',
                    gamesPerSet: 6,
                    pointsWin: 1,
                    pointsLoss: 0
                }
            },
            'office-badminton': {
                name: 'Office Badminton League',
                sport: 'badminton',
                format: 'round-robin',
                numTeams: 6,
                teams: [
                    'Shuttlers', 'Smash Squad', 'Drop Shot Team', 'Clear Kings',
                    'Net Masters', 'Rally Champs'
                ],
                config: {
                    games: 'Best of 3',
                    pointsPerGame: 21,
                    pointsWin: 2,
                    pointsDraw: 1,
                    pointsLoss: 0
                }
            },
            'world-cup': {
                name: 'World Cup Tournament',
                sport: 'football',
                format: 'group-knockout',
                numTeams: 16,
                teams: Array.from({length: 16}, (_, i) => `Team ${i + 1}`),
                config: {
                    groups: 4,
                    teamsPerGroup: 4,
                    matchDuration: 90,
                    pointsWin: 3,
                    pointsDraw: 1,
                    pointsLoss: 0
                }
            },
            'weekend-casual': {
                name: 'Weekend Fun Tournament',
                sport: 'custom',
                format: 'round-robin',
                numTeams: 6,
                teams: [
                    'Team Alpha', 'Team Beta', 'Team Gamma',
                    'Team Delta', 'Team Omega', 'Team Sigma'
                ],
                config: {
                    matchType: 'Flexible',
                    pointsWin: 2,
                    pointsDraw: 1,
                    pointsLoss: 0
                }
            }
        };

        // Tab switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // Wizard navigation
        function nextStep(stepNumber) {
            if (stepNumber === 2) {
                generateTeamInputs();
            } else if (stepNumber === 3) {
                updateScoringRules();
            } else if (stepNumber === 4) {
                updateConfigPreview();
            }

            document.querySelectorAll('.wizard-step').forEach(step => step.classList.remove('active'));
            document.getElementById('step' + stepNumber).classList.add('active');
            
            document.querySelectorAll('.wizard-progress-step').forEach((step, index) => {
                if (index < stepNumber) {
                    step.classList.add('completed');
                } else if (index === stepNumber - 1) {
                    step.classList.add('active');
                } else {
                    step.classList.remove('completed', 'active');
                }
            });
        }

        // Update sport-specific fields
        function updateSportFields() {
            const sport = document.getElementById('sportType').value;
            const customDiv = document.getElementById('customSportDiv');
            
            if (sport === 'custom') {
                customDiv.style.display = 'block';
            } else {
                customDiv.style.display = 'none';
            }
        }

        // Generate team input fields
        function generateTeamInputs() {
            const numTeams = parseInt(document.getElementById('numTeams').value);
            const container = document.getElementById('teamInputs');
            container.innerHTML = '<h3 style="margin: 20px 0;">Team Names</h3>';
            
            for (let i = 1; i <= numTeams; i++) {
                const div = document.createElement('div');
                div.className = 'form-group';
                div.innerHTML = `
                    <label>Team ${i}</label>
                    <input type="text" id="team${i}" placeholder="Enter team ${i} name" value="Team ${i}">
                `;
                container.appendChild(div);
            }
        }

        // Update scoring rules based on sport
        function updateScoringRules() {
            const sport = document.getElementById('sportType').value;
            const container = document.getElementById('scoringRules');
            
            if (sportConfigs[sport]) {
                const config = sportConfigs[sport];
                container.innerHTML = `
                    <div class="alert alert-info">
                        <strong>${config.icon} ${sport.toUpperCase()} Rules</strong><br>
                        Match Duration: ${config.matchDuration}<br>
                        Score tracking: ${config.scoreFields.join(', ')}
                    </div>
                `;
            } else {
                container.innerHTML = `
                    <div class="form-group">
                        <label>Match Duration</label>
                        <input type="text" id="matchDuration" placeholder="e.g., 45 minutes">
                    </div>
                    <div class="form-group">
                        <label>Score Fields (comma separated)</label>
                        <input type="text" id="scoreFields" placeholder="e.g., Goals, Points">
                    </div>
                `;
            }
        }

        // Update configuration preview
        function updateConfigPreview() {
            const name = document.getElementById('tournamentName').value;
            const sport = document.getElementById('sportType').value;
            const format = document.getElementById('tournamentFormat').value;
            const numTeams = document.getElementById('numTeams').value;
            const pointsWin = document.getElementById('pointsWin').value;
            const pointsDraw = document.getElementById('pointsDraw').value;
            
            const preview = document.getElementById('configPreview');
            preview.innerHTML = `
                <h4>Tournament Configuration</h4>
                <div class="config-item">
                    <span>Tournament Name:</span>
                    <strong>${name || 'Not set'}</strong>
                </div>
                <div class="config-item">
                    <span>Sport:</span>
                    <strong>${sport || 'Not selected'}</strong>
                </div>
                <div class="config-item">
                    <span>Format:</span>
                    <strong>${format}</strong>
                </div>
                <div class="config-item">
                    <span>Number of Teams:</span>
                    <strong>${numTeams}</strong>
                </div>
                <div class="config-item">
                    <span>Points System:</span>
                    <strong>Win: ${pointsWin}, Draw: ${pointsDraw}</strong>
                </div>
            `;
        }

        // Create tournament
        function createTournament() {
            const name = document.getElementById('tournamentName').value;
            const sport = document.getElementById('sportType').value;
            const format = document.getElementById('tournamentFormat').value;
            const numTeams = parseInt(document.getElementById('numTeams').value);
            
            if (!name || !sport) {
                alert('Please fill in all required fields!');
                return;
            }

            // Collect teams
            const teams = [];
            for (let i = 1; i <= numTeams; i++) {
                const teamName = document.getElementById(`team${i}`).value;
                teams.push({
                    id: i,
                    name: teamName,
                    played: 0,
                    won: 0,
                    drawn: 0,
                    lost: 0,
                    points: 0,
                    for: 0,
                    against: 0
                });
            }

            tournament = {
                name: name,
                sport: sport,
                format: format,
                teams: teams,
                matches: [],
                config: {
                    pointsWin: parseInt(document.getElementById('pointsWin').value),
                    pointsDraw: parseInt(document.getElementById('pointsDraw').value),
                    pointsLoss: parseInt(document.getElementById('pointsLoss').value)
                }
            };

            // Save to localStorage
            saveTournament();

            // Show success message
            alert('üéâ Tournament created successfully!');

            // Enable other tabs
            enableTournamentTabs();

            // Switch to teams tab
            document.querySelectorAll('.tab')[2].click();
        }

        // Load template
        function loadTemplate(templateId) {
            const template = templates[templateId];
            if (!template) return;

            // Fill in the form
            document.getElementById('tournamentName').value = template.name;
            document.getElementById('sportType').value = template.sport;
            document.getElementById('tournamentFormat').value = template.format;
            document.getElementById('numTeams').value = template.numTeams;

            // Generate team inputs and fill them
            generateTeamInputs();
            setTimeout(() => {
                template.teams.forEach((teamName, index) => {
                    const input = document.getElementById(`team${index + 1}`);
                    if (input) input.value = teamName;
                });
            }, 100);

            // Set config values
            if (template.config.pointsWin !== undefined) {
                document.getElementById('pointsWin').value = template.config.pointsWin;
            }
            if (template.config.pointsDraw !== undefined) {
                document.getElementById('pointsDraw').value = template.config.pointsDraw;
            }
            if (template.config.pointsLoss !== undefined) {
                document.getElementById('pointsLoss').value = template.config.pointsLoss;
            }

            // Create the tournament
            tournament = {
                name: template.name,
                sport: template.sport,
                format: template.format,
                teams: template.teams.map((name, index) => ({
                    id: index + 1,
                    name: name,
                    played: 0,
                    won: 0,
                    drawn: 0,
                    lost: 0,
                    points: 0,
                    for: 0,
                    against: 0
                })),
                matches: [],
                config: template.config
            };

            saveTournament();
            enableTournamentTabs();

            alert(`‚úÖ Loaded "${template.name}" template! You can customize it in the Setup tab or start managing teams.`);
            
            // Switch to teams tab
            document.querySelectorAll('.tab')[2].click();
        }

        // Enable tournament tabs
        function enableTournamentTabs() {
            document.getElementById('teamsAlert').style.display = 'none';
            document.getElementById('teamsContent').style.display = 'block';
            document.getElementById('scheduleAlert').style.display = 'none';
            document.getElementById('scheduleContent').style.display = 'block';
            document.getElementById('standingsAlert').style.display = 'none';
            document.getElementById('standingsContent').style.display = 'block';

            updateTeamsList();
            updateStandings();
        }

        // Update teams list
        function updateTeamsList() {
            const container = document.getElementById('teamsList');
            container.innerHTML = '';

            tournament.teams.forEach(team => {
                const card = document.createElement('div');
                card.className = 'team-card';
                card.innerHTML = `
                    <h4>${team.name}</h4>
                    <p>
                        P: ${team.played} | W: ${team.won} | D: ${team.drawn} | L: ${team.lost}<br>
                        Points: ${team.points}
                    </p>
                    <button class="btn btn-secondary" onclick="editTeam(${team.id})">Edit</button>
                    <button class="btn btn-danger" onclick="deleteTeam(${team.id})">Delete</button>
                `;
                container.appendChild(card);
            });
        }

        // Generate schedule
        function generateSchedule() {
            const matches = [];
            let matchId = 1;

            if (tournament.format === 'round-robin') {
                // Round-robin: everyone plays everyone once
                for (let i = 0; i < tournament.teams.length; i++) {
                    for (let j = i + 1; j < tournament.teams.length; j++) {
                        matches.push({
                            id: matchId++,
                            team1: tournament.teams[i],
                            team2: tournament.teams[j],
                            score1: null,
                            score2: null,
                            status: 'scheduled',
                            date: null
                        });
                    }
                }
            } else if (tournament.format === 'knockout') {
                // Simple knockout bracket
                const numRounds = Math.ceil(Math.log2(tournament.teams.length));
                let teamsInRound = [...tournament.teams];

                for (let round = 1; round <= numRounds; round++) {
                    for (let i = 0; i < teamsInRound.length; i += 2) {
                        if (i + 1 < teamsInRound.length) {
                            matches.push({
                                id: matchId++,
                                team1: teamsInRound[i],
                                team2: teamsInRound[i + 1],
                                score1: null,
                                score2: null,
                                status: 'scheduled',
                                round: round,
                                date: null
                            });
                        }
                    }
                    teamsInRound = teamsInRound.slice(0, Math.ceil(teamsInRound.length / 2));
                }
            }

            tournament.matches = matches;
            saveTournament();
            displayMatches();
            updateLiveMatchSelect();
        }

        // Display matches
        function displayMatches() {
            const container = document.getElementById('matchesList');
            container.innerHTML = '<h3 style="margin-top: 20px;">Matches</h3>';

            tournament.matches.forEach(match => {
                const card = document.createElement('div');
                card.className = 'match-card';
                
                let statusBadge = '';
                if (match.status === 'live') {
                    statusBadge = '<span class="badge badge-live">üî¥ LIVE</span>';
                } else if (match.status === 'completed') {
                    statusBadge = '<span class="badge badge-completed">‚úÖ Completed</span>';
                } else {
                    statusBadge = '<span class="badge badge-scheduled">üìÖ Scheduled</span>';
                }

                card.innerHTML = `
                    <div class="match-header">
                        <strong>Match ${match.id}</strong>
                        ${statusBadge}
                    </div>
                    <div class="match-teams">
                        <div class="match-team">
                            <h4>${match.team1.name}</h4>
                            <div class="match-score">${match.score1 !== null ? match.score1 : '-'}</div>
                        </div>
                        <div class="vs">VS</div>
                        <div class="match-team">
                            <h4>${match.team2.name}</h4>
                            <div class="match-score">${match.score2 !== null ? match.score2 : '-'}</div>
                        </div>
                    </div>
                    ${match.status !== 'completed' ? `
                        <button class="btn btn-primary" onclick="startMatch(${match.id})">
                            ${match.status === 'live' ? 'üìä Update Score' : '‚ñ∂Ô∏è Start Match'}
                        </button>
                    ` : ''}
                `;
                container.appendChild(card);
            });
        }

        // Update live match select dropdown
        function updateLiveMatchSelect() {
            const select = document.getElementById('liveMatchSelect');
            select.innerHTML = '<option value="">-- Select a Match --</option>';

            tournament.matches.forEach(match => {
                if (match.status !== 'completed') {
                    const option = document.createElement('option');
                    option.value = match.id;
                    option.textContent = `Match ${match.id}: ${match.team1.name} vs ${match.team2.name}`;
                    select.appendChild(option);
                }
            });

            document.getElementById('liveAlert').style.display = tournament.matches.length > 0 ? 'none' : 'block';
            document.getElementById('liveContent').style.display = tournament.matches.length > 0 ? 'block' : 'none';
        }

        // Start/load match for live scoring
        function startMatch(matchId) {
            const match = tournament.matches.find(m => m.id === matchId);
            if (!match) return;

            match.status = 'live';
            saveTournament();

            // Switch to live tab and load the match
            document.querySelectorAll('.tab')[4].click();
            document.getElementById('liveMatchSelect').value = matchId;
            loadLiveMatch();
        }

        // Load live match scoring interface
        function loadLiveMatch() {
            const matchId = parseInt(document.getElementById('liveMatchSelect').value);
            if (!matchId) {
                document.getElementById('liveScoreBoard').innerHTML = '';
                return;
            }

            const match = tournament.matches.find(m => m.id === matchId);
            if (!match) return;

            const board = document.getElementById('liveScoreBoard');
            board.innerHTML = `
                <div class="match-card">
                    <h3>Match ${match.id} - Live Scoring</h3>
                    <div class="match-teams">
                        <div class="match-team">
                            <h4>${match.team1.name}</h4>
                            <div class="score-input">
                                <input type="number" id="score1" value="${match.score1 !== null ? match.score1 : 0}" min="0">
                            </div>
                        </div>
                        <div class="vs">VS</div>
                        <div class="match-team">
                            <h4>${match.team2.name}</h4>
                            <div class="score-input">
                                <input type="number" id="score2" value="${match.score2 !== null ? match.score2 : 0}" min="0">
                            </div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn btn-success" onclick="updateMatchScore(${matchId})">üíæ Save Score</button>
                        <button class="btn btn-primary" onclick="completeMatch(${matchId})">‚úÖ Complete Match</button>
                    </div>
                </div>
            `;
        }

        // Update match score
        function updateMatchScore(matchId) {
            const match = tournament.matches.find(m => m.id === matchId);
            if (!match) return;

            const score1 = parseInt(document.getElementById('score1').value) || 0;
            const score2 = parseInt(document.getElementById('score2').value) || 0;

            match.score1 = score1;
            match.score2 = score2;

            saveTournament();
            alert('Score updated successfully!');
        }

        // Complete match and update standings
        function completeMatch(matchId) {
            const match = tournament.matches.find(m => m.id === matchId);
            if (!match) return;

            const score1 = parseInt(document.getElementById('score1').value) || 0;
            const score2 = parseInt(document.getElementById('score2').value) || 0;

            match.score1 = score1;
            match.score2 = score2;
            match.status = 'completed';

            // Update team statistics
            const team1 = tournament.teams.find(t => t.id === match.team1.id);
            const team2 = tournament.teams.find(t => t.id === match.team2.id);

            team1.played++;
            team2.played++;
            team1.for += score1;
            team1.against += score2;
            team2.for += score2;
            team2.against += score1;

            if (score1 > score2) {
                team1.won++;
                team2.lost++;
                team1.points += tournament.config.pointsWin;
                team2.points += tournament.config.pointsLoss;
            } else if (score2 > score1) {
                team2.won++;
                team1.lost++;
                team2.points += tournament.config.pointsWin;
                team1.points += tournament.config.pointsLoss;
            } else {
                team1.drawn++;
                team2.drawn++;
                team1.points += tournament.config.pointsDraw;
                team2.points += tournament.config.pointsDraw;
            }

            saveTournament();
            alert('Match completed!');
            
            updateTeamsList();
            updateStandings();
            displayMatches();
            updateLiveMatchSelect();
            updateStats();
        }

        // Update standings table
        function updateStandings() {
            const tbody = document.getElementById('standingsBody');
            tbody.innerHTML = '';

            // Sort teams by points, then goal difference
            const sortedTeams = [...tournament.teams].sort((a, b) => {
                if (b.points !== a.points) return b.points - a.points;
                return (b.for - b.against) - (a.for - a.against);
            });

            sortedTeams.forEach((team, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${index + 1}</strong></td>
                    <td>${team.name}</td>
                    <td>${team.played}</td>
                    <td>${team.won}</td>
                    <td>${team.drawn}</td>
                    <td>${team.lost}</td>
                    <td><strong>${team.points}</strong></td>
                `;
                tbody.appendChild(row);
            });
        }

        // Update statistics
        function updateStats() {
            const completedMatches = tournament.matches.filter(m => m.status === 'completed').length;
            const totalMatches = tournament.matches.length;
            const totalGoals = tournament.teams.reduce((sum, team) => sum + team.for, 0);

            const grid = document.getElementById('statsGrid');
            grid.innerHTML = `
                <div class="stat-card">
                    <div class="label">Total Matches</div>
                    <div class="number">${totalMatches}</div>
                </div>
                <div class="stat-card">
                    <div class="label">Completed</div>
                    <div class="number">${completedMatches}</div>
                </div>
                <div class="stat-card">
                    <div class="label">Remaining</div>
                    <div class="number">${totalMatches - completedMatches}</div>
                </div>
                <div class="stat-card">
                    <div class="label">Total ${tournament.sport === 'football' ? 'Goals' : 'Points'}</div>
                    <div class="number">${totalGoals}</div>
                </div>
            `;

            if (completedMatches > 0) {
                document.getElementById('statsAlert').style.display = 'none';
                document.getElementById('statsContent').style.display = 'block';

                // Top performers
                const topScorers = [...tournament.teams]
                    .sort((a, b) => b.for - a.for)
                    .slice(0, 5);

                const performersDiv = document.getElementById('topPerformers');
                performersDiv.innerHTML = `
                    <table>
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Team</th>
                                <th>${tournament.sport === 'football' ? 'Goals' : 'Points'} Scored</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${topScorers.map((team, index) => `
                                <tr>
                                    <td>${index + 1}</td>
                                    <td>${team.name}</td>
                                    <td><strong>${team.for}</strong></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            }
        }

        // Add new team
        function addNewTeam() {
            const teamName = prompt('Enter team name:');
            if (!teamName) return;

            const newTeam = {
                id: tournament.teams.length + 1,
                name: teamName,
                played: 0,
                won: 0,
                drawn: 0,
                lost: 0,
                points: 0,
                for: 0,
                against: 0
            };

            tournament.teams.push(newTeam);
            saveTournament();
            updateTeamsList();
            updateStandings();
        }

        // Edit team
        function editTeam(teamId) {
            const team = tournament.teams.find(t => t.id === teamId);
            if (!team) return;

            const newName = prompt('Enter new team name:', team.name);
            if (newName && newName !== team.name) {
                team.name = newName;
                saveTournament();
                updateTeamsList();
                displayMatches();
                updateStandings();
            }
        }

        // Delete team
        function deleteTeam(teamId) {
            if (!confirm('Are you sure you want to delete this team? This will also remove all their matches.')) {
                return;
            }

            tournament.teams = tournament.teams.filter(t => t.id !== teamId);
            tournament.matches = tournament.matches.filter(m => 
                m.team1.id !== teamId && m.team2.id !== teamId
            );

            saveTournament();
            updateTeamsList();
            displayMatches();
            updateStandings();
        }

        // Export functions
        function exportSchedule() {
            const csv = 'Match,Team 1,Team 2,Score 1,Score 2,Status\n' +
                tournament.matches.map(m => 
                    `${m.id},${m.team1.name},${m.team2.name},${m.score1 || ''},${m.score2 || ''},${m.status}`
                ).join('\n');

            downloadCSV(csv, 'schedule.csv');
        }

        function exportStandings() {
            const csv = 'Position,Team,Played,Won,Drawn,Lost,Points\n' +
                [...tournament.teams]
                    .sort((a, b) => b.points - a.points)
                    .map((t, i) => `${i+1},${t.name},${t.played},${t.won},${t.drawn},${t.lost},${t.points}`)
                    .join('\n');

            downloadCSV(csv, 'standings.csv');
        }

        function downloadCSV(csv, filename) {
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
        }

        // Local storage functions
        function saveTournament() {
            localStorage.setItem('tournament', JSON.stringify(tournament));
        }

        function loadTournament() {
            const saved = localStorage.getItem('tournament');
            if (saved) {
                tournament = JSON.parse(saved);
                if (tournament.teams.length > 0) {
                    enableTournamentTabs();
                    displayMatches();
                    updateLiveMatchSelect();
                    updateStats();
                }
            }
        }

        // Initialize on load
        window.onload = function() {
            loadTournament();
        };
    </script>
</body>
</html>